{% extends "base.html" %}
{% load static %}
{% load to_jalali_filters %}
{% load widget_tweaks %}
{% load ui_template_tag %}

{% block title %}
مدیریت موجودی اولیه
{% endblock title %}

{% block breadcrumbs %}
{% breadcrumbs 'عملیات تجارت داخلی' '#' 'مدیریت موجودی اولیه' '#' %}
{% endblock breadcrumbs %}

{% block page-title %}
مدیریت موجودی اولیه
{% endblock page-title %}

{% block main %}
<link rel="stylesheet" href="{% static 'persianDatepicker/css/persianDatepicker-default.css' %}">
<link rel='stylesheet' href='https://cdn.datatables.net/2.3.4/css/dataTables.dataTables.css' media='all' />

<div class="container-fluid">
    <div class="bg-white p-3 request-main-data">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-xs-12 col-sm-12">
 
                    <div class="row">
                        <!-- دکمه‌های عملیاتی -->
                        <div class="col-md-12 mb-3 box-bordered-bottom-dashed">
                            <a href="{% url 'foreintrade:product_ezhar_vorood_kala' %}" class="btn btn-primary me-2" id="NewFactor"><i class="fa fa-plus-square"></i> اظهار ورود جدید </a>
                            <a href="#" class="btn btn-success me-2" id="NewFactor"><i class="fa fa-plus-square"></i>  ثبت سند با فایل اکسل </a>
                            <a href="#" class="btn btn-primary me-2" id="NewFactor"><i class="fa fa-plus-square"></i> استعلام واردات </a>
                        </div>


                        <div class="row">
                            <!-- وضعیت سند -->
                            <div class="col-md-4 mb-3">
                                <div class="input-group">
                                    <span class="input-group-text bg-light">وضعیت سند</span>
                                    <select id="statusId" name="statusId"
                                        class="form-control select-status">
                                        <option value="0" selected="selected">همه</option>
                                        <option value="1">پیش نویس</option>
                                        <option value="2">ثبت اولیه</option>
                                        <option value="3">در حال استعلام شناسه های رهگیری</option>
                                        <option value="6">تأیید شناسه های رهگیری</option>
                                        <option value="4">عدم تأیید شناسه های رهگیری</option>
                                        <option value="7">تایید شده</option>
                                        <option value="8">ابطال شده</option>
                                        <option value="17">تایید نهایی</option>
                                        <option value="19">در انتظار پرداخت</option>
                                    </select>
                                </div>
                            </div>
                            <!-- نوع سند -->
                            <div class="col-md-4 mb-3">
                                <div class="input-group">
                                    <span class="input-group-text bg-light">نوع سند</span>
                                    <select id="DocType" name="DocType"
                                        class="form-control select-status">
                                        <option value="">انتخاب کنید</option>
                                        <option value="4">اظهار موجودی اولیه</option>
                                        <option value="5">اظهار خرید / دریافت</option>
                                        <option value="6">اظهار واردات</option>
                                        <option value="7">انبارگردانی(افزایشی)</option>
                                        <option value="10">بدون موجودی اولیه</option>
                                        <option value="12">اظهار برگشت از فروش</option>
                                        <option value="2">واردات</option>
                                        <option value="14">پیش اظهار ورود کالا</option>
                                        <option value="17">ورود کالای تفکیک/تجمیع/بسته بندی</option>
                                    </select>
                                </div>
                            </div>
                            <!-- انبار -->
                            <div class="col-md-4 mb-3">
                                <div class="input-group">
                                    <span class="input-group-text bg-light">انبار</span>
                                    <select name="WhereHouse" id="WhereHouse"
                                        data-handler="InternalTradeHandler"
                                        data-function="UserWhereHouse_WithTempStore_Direct"
                                        class="form-control ajaxSelect">
                                        <option value="" selected="selected">انتخاب کنید</option>
                                        <option value="0">انبار موقت</option>
                                        {% for anbar in user_anbars %}
                                            <option value="{{ anbar.id }}" postalcode="{{ anbar.postal_code }}"> {{ anbar.name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <!-- از تاریخ - تا تاریخ -->
                            <div class="col-md-4 mb-3">
                                <div class="input-group">
                                    <span class="input-group-text bg-light">از تاریخ - تا تاریخ</span>
                                    <input type="text" id="startDate" placeholder="از تاریخ"
                                        autocomplete="off" name="startDate"
                                        class="persianDatePicker1 form-control max-date1 pwt-datepicker-input-element"
                                        style="width: 50%">
                                    <input type="text" id="endDate" placeholder="تا تاریخ"
                                        autocomplete="off" name="endDate"
                                        class="persianDatePicker1 form-control max-date1 pwt-datepicker-input-element"
                                        style="width: 50%">
                                </div>
                            </div>
                            <!-- متن جستجو -->
                            <div class="col-md-4 mb-3">
                                <div class="input-group">
                                    <span class="input-group-text bg-light">متن جستجو</span>
                                    <input name="searchTerm" id="searchTerm" type="text"
                                        class="form-control search-box"
                                        onkeydown="return (event.keyCode != 13);">
                                </div>
                            </div>
                            <!-- دکمه‌های جستجو و لغو -->
                            <div class="col-md-3 mb-3">
                                <div class="input-group">
                                    <button type="button" id="btnSearchInitialInventory"
                                        name="btnSearchInitialInventory" class="btn btn-primary me-2"><i
                                            class="fa fa-search"></i> جستجو</button>
                                    <button type="button" id="btnSearchInitialInventoryLeft"
                                        name="btnSearchInitialInventoryLeft" class="btn btn-warning"><i
                                            class="fa fa-remove"></i> لغو فیلتر</button>
                                </div>
                            </div>
                        </div>
                    </div>


                     <div class="table-responsive">
                        <table id="example" class="display">
                            <thead>
                                <tr>
                                    <th>ردیف</th>
                                    <th>شماره سند</th>
                                    <th>تاریخ سند</th>
                                    <th>تاریخ ثبت</th>
                                    <th>انبار</th>
                                    <th>نوع سند</th>
                                    <th>وضعیت</th>
                                    <th>شرح</th>
                                    <th>عملیات</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for document in documenttradeoperation_list %}
                                <tr>
                                    <td>{{ forloop.counter }}</td>
                                    <td>{{ document.document_number }}</td>
                                    <td>{{ document.document_date|to_jalali }}</td>
                                    <td>{{ document.register_date|to_jalali }}</td>
                                    <td>{{ document.anbar.name }}</td>
                                    <td>{{ document.document_type }}</td>
                                    <td>{{ document.get_status_display }}</td>
                                    <td>{{ document.description }}</td>
                                    <td>
                                        <a href="#" class="btn btn-sm btn-primary">مشاهده</a>
                                        <a href="#" class="btn btn-sm btn-warning">ویرایش</a>
                                        <a href="#" class="btn btn-sm btn-danger">حذف</a>
                                    </td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="9" class="text-center">هیچ سندی یافت نشد.</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>

                    </div>

            </div>
        </div>
    </div>
</div>



<style>
    .input-group-text.bg-light {
        width: 120px;
    }

    .btn-purple-csm {
        background-color: #6f42c1 !important;
        color: #fff;
    }

    .btn-purple-csm:hover {
        background-color: #5a32a3 !important;
    }

    .dropdown-menu {
        min-width: 100%;
    }

    .text-align-center {
        text-align: center !important;
    }

    .bg-themeprimary {
        background-color: #024158 !important;
        color: white;
    }

    .bg-themeprimary th {
        text-align: center !important;
    }

    .table-responsive {
        overflow-x: auto;
    }

    .hidden {
        display: none;
    }

    div.dt-container div.dt-layout-row div.dt-layout-cell.dt-layout-start {
        margin-right: initial !important;
    }

    div.dt-container div.dt-layout-row div.dt-layout-cell.dt-layout-end {
        margin-left: initial !important;
    }
</style>



{% endblock main %}

{% block js %}

<script>
    $(document).ready(function () {


        // اینیشیالایز DataTable
        $('#example').DataTable({
            paging: true,
            searching: true,
            info: true,
            ordering: false,
            pageLength: 10,
            language: {
                "sEmptyTable": "هیچ داده‌ای در جدول وجود ندارد",
                "sInfo": "نمایش _START_ تا _END_ از _TOTAL_ رکورد",
                "sInfoEmpty": "نمایش 0 تا 0 از 0 رکورد",
                "sInfoFiltered": "(فیلتر شده از _MAX_ رکورد)",
                "sLengthMenu": "نمایش _MENU_ رکورد",
                "sLoadingRecords": "در حال بارگذاری...",
                "sProcessing": "در حال پردازش...",
                "sSearch": "جستجو:",
                "sZeroRecords": "رکوردی مطابق جستجوی شما پیدا نشد",
                "oPaginate": {
                    "sFirst": "اولین",
                    "sLast": "آخرین",
                    "sNext": "بعدی",
                    "sPrevious": "قبلی"
                }
            },

        });


        $('.persianDatePicker1, .persianDatePicker2').each(function () {
            $(this).persianDatepicker({
                format: 'YYYY/MM/DD',
                autoClose: true,
                toolbox: {
                    calendarSwitch: {
                        enabled: false
                    }
                }
            });
        });
    });
</script>


{% endblock js %}