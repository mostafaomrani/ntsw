{% extends "base.html" %}
{% load static %}
{% load date_filters %}
{% load ui_template_tag %}
{% load widget_tweaks %}
{% block title %}
    ایجاد منشا ارزی بانکی
{% endblock title %}
{% block page-title %}
    ایجاد منشا ارزی بانکی
{% endblock page-title %}
{% block breadcrumbs %}
    {% breadcrumbs 'عملیات ارزی' '#' 'تعیین منشا ارز' '#' 'منشا ارز بانکی' 'currency_origin_determining:create_banking' 'ایجاد منشا ارزی بانکی' '#' %}
{% endblock breadcrumbs %}
{% block head %}
    <link href="{% static 'selectize-master/css/selectize.css' %}"
          rel="stylesheet">
    <link href="{% static 'bootstrap-datepicker/css/bootstrap-datepicker.min.css' %}"
          rel="stylesheet">
{% endblock head %}
{% block main %}
    <div class="container-fluid bg-white py-4">
        {% if ware_formset.errors %}{{ ware_formset.errors }}{% endif %}
        {% if form.errors %}{{ form.errors }}{% endif %}
        <form method="post" id="banking-form" class="needs-validation" novalidate>
            {% csrf_token %}
            {{ ware_formset.management_form }}
            {{ lading_bill_formset.management_form }}
            <div class="row">
                {% include "partials/show_errors.html" %}
                {% widget_tweaks_field form.shipping_document  'col-12 col-sm-6 col-lg-4' placeholder='انتخاب کنید' control_class="p-0" %}
                {% widget_tweaks_field form.pay_number 'col-12 col-sm-6 col-lg-4' %}
                <div class="w-100"></div>
                {% widget_tweaks_field form.origin_country  'col-12 col-sm-6 col-lg-4' placeholder='انتخاب کنید' control_class="p-0" %}
                {% widget_tweaks_field form.entrance_edge  'col-12 col-sm-6 col-lg-4' placeholder='انتخاب کنید'  control_class="p-0" %}
                {% widget_tweaks_field form.custom_destination  'col-12 col-sm-6 col-lg-4' placeholder='انتخاب کنید'  control_class="p-0" %}
                {% widget_tweaks_field form.fob_amount 'col-12 col-sm-6 col-lg-4' %}
                {% widget_tweaks_field form.shipping_price 'col-12 col-sm-6 col-lg-4' %}
                {% widget_tweaks_field form.inspection_amount 'col-12 col-sm-6 col-lg-4' %}
                {% widget_tweaks_field form.off 'col-12 col-sm-6 col-lg-4' %}
                {% widget_tweaks_field form.other_cost 'col-12 col-sm-6 col-lg-4' %}
                {% widget_tweaks_field form.total_price 'col-12 col-sm-6 col-lg-4' %}
                {% widget_tweaks_field form.lading_bill_fob 'col-12 col-sm-6 col-lg-4' %}
                <div class="col-12">
                    <p class="text-danger">توجه: مجموع مبلغ فوب کالاهای انتخاب شده از جدول پایین، باید با مبلغ فوب سند حمل برابر باشد.</p>
                </div>
                <div class="col-12">
                    <div class="border rounded">
                        <p class=" bg-gray p-2">افزودن بارنامه</p>
                        <div class="row m-3">
                            <div class="col-12 col-md-6 col-lg-8">
                                <div class="row">
                                    {% input_box 'شماره بارنامه' '' False 'text' 'col-12' '' 'billing_number' %}
                                    {% input_box 'تاریخ بارنامه' '' False 'date' 'col-12' '' 'billing_date' %}
                                    <div class="text-center">
                                        <button type="button" id="add-bill" class="btn  btn-primary btn-maya">افزودن به لیست</button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-md-6 col-lg-4">
                                <table class="table table-striped table-hover table-bordered text-center">
                                    <thead class="text-white bg-navy">
                                        <tr>
                                            <th>شماره بارنامه</th>
                                            <th>تاریخ بارنامه</th>
                                            <th>حذف</th>
                                        </tr>
                                    </thead>
                                    <tbody id="billing-body" class="text-center">
                                    </tbody>
                                </table>
                                <div class="d-flex justify-content-center">
                                    <div class="m-2">
                                        <button type="button" class="btn  btn-danger rounded-2px" id="remove-billing">حذف از لیست</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 mt-3">
                    <table class="table table-striped table-hover table-bordered text-center">
                        <thead class="text-white bg-navy">
                            <tr>
                                <th>ردیف</th>
                                <th>انتخاب</th>
                                <th>کد تعرفه</th>
                                <th>شرح تجاری فارسی</th>
                                <th>قیمت واحد</th>
                                <th>واحد اندازه گیری</th>
                                <th>وزن ناخالص</th>
                                <th>وزن خالص</th>
                                <th>مقدار/تعداد</th>
                                <th>نوع بسته</th>
                                <th>تعداد بسته</th>
                                <th>مبلغ فوب</th>
                            </tr>
                        </thead>
                        <tbody id="ware-table-body">
                            {% for w, form in combined_ware_formset %}
                                <tr>
                                    <td>{{ forloop.counter }}</td>
                                    <td>{% render_field form.DELETE class="form-check-input ware-checkbox" type="checkbox" %}</td>
                                    <td>{{ w.hs_code }}</td>
                                    <td>{{ w.persian_title }}</td>
                                    <td>{{ w.unit_price }}</td>
                                    <td>{{ w.get_unit_display }}</td>
                                    <td>{% render_field form.gross_weight class="form-control ware-input"  %}</td>
                                    <td>{% render_field form.net_weight class="form-control ware-input"  %}</td>
                                    <td>{% render_field form.amount class="form-control ware-input"  %}</td>
                                    <td>{{ w.packing_type }}</td>
                                    <td>{% render_field form.packing_count class="form-control ware-input"  %}</td>
                                    <td>
                                        <span class="ware-fob">{{ w.fob_price }}</span>
                                        <input type="hidden"
                                               name="wares-{{ forloop.counter0 }}-order_registraiton_ware"
                                               id="id_wares-{{ forloop.counter0 }}-order_registraiton_ware"
                                               value="{{ w.pk }}">
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="col-12">
                    <div class="d-flex justify-content-end">
                        <div class="mt-3">
                            <button class="btn  btn-primary btn-maya" type="submit">ثبت</button>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
{% endblock main %}
{% block js %}
    <script src="{% static 'currency_origin_determining/create_banking.js' %}"></script>
{% endblock js %}
